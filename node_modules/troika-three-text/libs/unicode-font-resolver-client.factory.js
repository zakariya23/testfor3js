/*!
Custom bundle of @unicode-font-resolver/client v1.0.0 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/
export default function(){return function(t){"use strict";var n=function(){this.buckets=new Map};n.prototype.add=function(t){var n=t>>5;this.buckets.set(n,(this.buckets.get(n)||0)|1<<(31&t))},n.prototype.has=function(t){var n=this.buckets.get(t>>5);return void 0!==n&&0!=(n&1<<(31&t))},n.prototype.serialize=function(){var t=[];return this.buckets.forEach((function(n,r){t.push((+r).toString(36)+":"+n.toString(36))})),t.join(",")},n.prototype.deserialize=function(t){var n=this;this.buckets.clear(),t.split(",").forEach((function(t){var r=t.split(":");n.buckets.set(parseInt(r[0],36),parseInt(r[1],36))}))};var r=Math.pow(2,8),e=r-1,o=~e;function i(t){var n=function(t){return t&o}(t).toString(16),e=function(t){return(t&o)+r-1}(t).toString(16);return"codepoint-index/plane"+(t>>16)+"/"+n+"-"+e+".json"}function a(t,n){var r=t&e,o=n.codePointAt(r/6|0);return 0!=((o=(o||48)-48)&1<<r%6)}function u(t,n){var r;(r=t,r.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(t){return t.split("-").map((function(t){return parseInt(t.trim(),16)}))}))).forEach((function(t){var r=t[0],e=t[1];void 0===e&&(e=r),n(r,e)}))}function s(t,n){u(t,(function(t,r){for(var e=t;e<=r;e++)n(e)}))}var c={},f={},l=new WeakMap,v="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.0/packages/data";function d(t){var r=l.get(t);return r||(r=new n,s(t.ranges,(function(t){return r.add(t)})),l.set(t,r)),r}var h,p=new Map;function g(t,n,r){return t[n]?n:t[r]?r:function(t){for(var n in t)return n}(t)}function w(t,n){var r=n;if(!t.includes(r)){r=1/0;for(var e=0;e<t.length;e++)Math.abs(t[e]-n)<Math.abs(r-n)&&(r=t[e])}return r}function y(t){return h||(h=new Set,s("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(t){h.add(t)}))),h.has(t)}return t.CodePointSet=n,t.clearCache=function(){c={},f={}},t.getFontsForString=function(t,n){void 0===n&&(n={});var r=n.lang;void 0===r&&(r="en");var e=n.category;void 0===e&&(e="sans-serif");var o=n.style;void 0===o&&(o="normal");var u=n.weight;void 0===u&&(u=400);var s=(n.dataUrl||v).replace(/\/$/g,""),l=new Map,h=new Uint8Array(t.length),m={},b={},k=new Array(t.length),A=new Map,M=!1;function j(t){var n=p.get(t);return n||(n=fetch(s+"/"+t).then((function(t){if(!t.ok)throw new Error(t.statusText);return t.json().then((function(t){if(!Array.isArray(t)||1!==t[0])throw new Error("Incorrect schema version; need 1, got "+t[0]);return t[1]}))})).catch((function(n){if(s!==v)return M||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+s+'", trying default CDN. '+n.message),M=!0),s=v,p.delete(t),j(t);throw n})),p.set(t,n)),n}for(var P=function(n){var r=t.codePointAt(n),e=i(r);k[n]=e,c[e]||A.has(e)||A.set(e,j(e).then((function(t){c[e]=t}))),r>65535&&(n++,S=n)},S=0;S<t.length;S++)P(S);return Promise.all(A.values()).then((function(){A.clear();for(var n=function(n){var o=t.codePointAt(n),i=null,u=c[k[n]];t:for(var s in u){var l=b[s];if(void 0===l&&(l=b[s]=new RegExp(s).test(r)),l)for(var v in u[s])if(a(o,u[s][v])){i=v;break t}}i||(console.debug("No font coverage for U+"+o.toString(16)),i="latin"),k[n]=i,f[i]||A.has(i)||A.set(i,j("font-meta/"+i+".json").then((function(t){f[i]=t}))),o>65535&&(n++,e=n)},e=0;e<t.length;e++)n(e);return Promise.all(A.values())})).then((function(){for(var n,r=null,i=0;i<t.length;i++){var a=t.codePointAt(i);if(r&&(y(a)||d(r).has(a)))h[i]=h[i-1];else{r=f[k[i]];var c=m[r.id];if(!c){var v=r.typeforms,p=g(v,e,"sans-serif"),b=g(v[p],o,"normal"),A=w(null===(n=v[p])||void 0===n?void 0:n[b],u);c=m[r.id]=s+"/font-files/"+r.id+"/"+p+"."+b+"."+A+".woff"}var M=l.get(c);null==M&&(M=l.size,l.set(c,M)),h[i]=M}a>65535&&(i++,h[i]=h[i-1])}return{fontUrls:Array.from(l.keys()),chars:h}}))},Object.defineProperty(t,"__esModule",{value:!0}),t}({})}
